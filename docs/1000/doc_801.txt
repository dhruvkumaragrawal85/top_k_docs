' ' </sup> modulo ' ' V <sub> &amp;lambda ; </sub> ' ' . Notice the preimage of ' ' W <sub> &amp;mu ; </sub> ' ' under the quotient @ @ @ @ @ @ @ @ @ @ ' that contains ' ' V <sub> &amp;lambda ; </sub> ' ' . Continue this way until the resulting quotient space has dimension 0 . Then the successive preimages of the eigenspaces found at each step form a flag that ' ' A ' ' stabilizes. # Notes # Although every square matrix has a Schur decomposition , in general this decomposition is not unique . For example , the eigenspace ' ' V <sub> &amp;lambda ; </sub> ' ' can have dimension 1 , in which case any orthonormal basis for ' ' V <sub> &amp;lambda ; </sub> ' ' would lead to the desired result . Write the triangular matrix ' ' U ' ' as ' ' U ' ' = ' ' D ' ' + ' ' N ' ' , where ' ' D ' ' is diagonal and ' ' N ' ' is strictly upper triangular ( and thus a nilpotent matrix ) . The diagonal matrix ' ' D ' ' contains the eigenvalues of ' ' A ' ' in arbitrary order ( hence its Frobenius norm , squared , is @ @ @ @ @ @ @ @ @ @ ' ' A ' ' , while the Frobenius norm of ' ' A ' ' , squared , is the sum of the squared singular values of ' ' A ' ' ) . The nilpotent part ' ' N ' ' is generally not unique either , but its Frobenius norm is uniquely determined by ' '